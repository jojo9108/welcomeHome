<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>commentList</title>
<script>
	window.onload = function() {
		loadCommentList();
	}
	//목록조회.
	function loadCommentList() {
		let xhtp = new XMLHttpRequest();
		xhtp.open('get', '../CommentServlet?cmd=selectAll');
		xhtp.send();
		xhtp.onload = loadCommentResult;
	}
	//목록조회 콜백.
	function loadCommentResult() {
		let xmlDoc = this.responseXML;
		let code = xmlDoc.getElementsByTagName('code')[0].innerHTML;
		console.log(code);
		if (code == 'success') {
			let commentList = xmlDoc.getElementsByTagName('row');
			let listDiv = document.getElementById('commentList');
			for (let i = 0; i < commentList.length; i++) { //row태그(id, name, content)를 가져와 commentList밑에 붙여넣음.
				let commentDiv = makeCommentView(commentList[i]); //makeCommentView => row를 가져와서 commentDiv에 넣어주고 그것을 listDiv에 붙여넣음.
				listDiv.appendChild(commentDiv);
			}
		} else if (code == 'error') {
			let msg = xmlDoc.getElementsByTagName('data')[0].innerHTML;
			window.alert(msg);
		}
	}
	function makeCommentView(comment) {
		let div = document.createElement('div');
		div.setAttribute('id', comment.children[2].innerHTML);

		let str = '<strong>' + comment.children[1].innerHTML + '</strong>'
				+ comment.children[2].innerHTML
				+ '<input type ="button" value="수정" onclick="viewUpdateForm">'
				+ '<input type ="button" value="삭제" onclick="confirmDeletion">'
		div.innerHTML = str;
		return div;

	}
</script>
</head>
<body>
	<!-- 댓글목록 -->
	<div id='commentList'></div>
	<!-- 댓글등록화면 -->
	<div id='commentAdd'>
		<form name='addForm' action=''>
			이름: <input type='text' name='name' size='10'><br> 내용:
			<textarea name='content' cols='20' rows='3'></textarea>
			<input type='button' value='등록' onclick='addComment()'>
		</form>
	</div>
	<!-- 댓글수정화면 -->
	<div id='commentUpdate' style="display: none;">
		<form name='updateForm' action=''>
			<input type='hidden' name='id'> 이름: <input type='text'
				name='name' size='10'><br> 내용:
			<textarea name='content' cols='20' rows='3'></textarea>
			<input type='button' value='변경' onclick='updateComment()'> <input
				type='button' value='취소' onclick='cancelComment()'>
		</form>
	</div>
</body>
</html>